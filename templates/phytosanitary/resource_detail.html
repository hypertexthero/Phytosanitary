{% extends "phytosanitary/base_resources.html" %}

{% block title %}{{ object.title }} - {{ block.super }}{% endblock %}

{% block breadcrumbs %} &rarr; <a href="/{{ object.pub_date|date:"Y" }}/">{{ object.pub_date|date:"Y" }}</a> &rarr; <a href="/{{ object.pub_date|date:"Y" }}/{{ object.pub_date|date:"b" }}/">{{ object.pub_date|date:"F" }}</a> &rarr; <a href="/{{ object.pub_date|date:"Y" }}/{{ object.pub_date|date:"b" }}/{{ object.pub_date|date:"d" }}">{{ object.pub_date|date:"d" }}</a> &rarr; {{ object.title }}{% endblock %}

{% block content %}
    
    
    {% if user.is_staff %} 
    <div class="editingtoolbar floatright">
        <a href="/admin/phytosanitary/resource/{{ object.id }}">Edit this resource</a>{# TODO: this URL is hackish - make it better #}
        {# <a class="warning" href="{% url notes_delete note.id %}">delete</a> #}
    </div>
    {% endif %}
    

    <h1 class="first">{{ object.title }}</h1>
    
    <p><i>By {{ user.first_name }} {{ user.last_name }} on {{ object.pub_date|date:"l, d F Y" }}</i></p>
    
    {{ object.body_html|safe }}
    
    {% if object.file %}        

        <h2>Files</h2>
    
        {# todo:  #}
        {#      #}
        {#     - implement ability to add more than one file per resource submission  #}
        {#     - file icon or text based on file extension #}
        
        <p><a href="/uploads/{{ object.file }}">{{ object.file }}</a></p>

    {% endif %}
    

{% endblock %}

{% block sidebar %}
    <h2>About This Page</h2>

    <p>This resource was published on {{ object.pub_date|date:"F j, Y" }} 
    {% if object.categories.count %}
    in the {% for category in object.categories.all %}
                <a href="{{ category.get_absolute_url }}">{{ category.title }}</a>{% if forloop.last %}{% else %}{% ifequal forloop.revcounter0 1 %}and {% else %}, {% endifequal %}.{% endif %}{% endfor %} categor{{ object.categories.count|pluralize:"y,ies" }}.
    {% else %}
        {# <p>This resource isn't part of any categories.</p> #}
    {% endif %}

    {% if object.etags.count %}
    It is tagged {% for tag in object.etags %}<a href="{% url phytosanitary_resource_archive_tag tag.name %}">{{ tag.name }}</a>{% if forloop.last %}{% else %}{% ifequal forloop.revcounter0 1 %}and {% else %}, {% endifequal %}{% endif %}{% endfor %}.
        </p>
    {% else %}
        {# <p>This resource doesn't have any tags.</p> #}
    {% endif %}
    
    {# todo: automatically only display fields that have values entered: #}
    {# - http://stackoverflow.com/a/2217558/412329 #}
    {# - http://stackoverflow.com/questions/2170228/django-iterate-over-model-instance-field-names-and-values-in-template/2226150#2226150 #}
    {# - http://stackoverflow.com/a/2311015/412329 #}
    
    {# {% for instance in data %} #}
    {#     {% for field, value in instance.fields.items %} #}
    {#         {{ field }}: {{ value }} #}
    {#     {% endfor %} #}
    {# {% endfor %} #}
    
    <dl>
        <dt>URL</dt>
        <dd>{{ object.url }}</dd>
    </dl>
    
    
{% endblock %}

{# TODO for future - commenting system #}
{# http://stackoverflow.com/a/4832313/412329 #}

{# <h2>Comments</h2> #}
{# {% load comments %} #}
{# {% load markup %} #}
{# {% get_comment_list for object as comment_list %} #}
{#  #}
{# {% for comment in comment_list %} #}
{#     <p><strong>On {{ comment.submit_date|date:"F j, Y" }}, {{ comment.name }} said:</strong></p> #}
{#  #}
{#     {{ comment.comment|markdown:"safe" }} #}
{# {% endfor %} #}
{#  #}
{# <h3>Post a comment</h3> #}
{#      #}
{#     <div id="commentform"> #}
{# {% render_comment_form for object %} #}
{#     </div> #}

{# {% load comments %} #}
{# {% get_comment_count for object as comment_count %} #}
{# So far, this resource has {{ comment_count }} comment{{ comment_count|pluralize }}. #}